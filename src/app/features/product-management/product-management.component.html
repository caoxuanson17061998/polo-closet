<div class="header">
  <div class="search">
    <input
      type="text"
      placeholder="Search ..."
      (keyup.enter)="onSearch($event)" />
    <i class="pi pi-search"></i>
  </div>
  <button (click)="onAddProduct()" class="add-product">
    <i class="pi pi-plus"></i>
    Thêm sản phẩm
  </button>
</div>

<p-table [value]="productsByCondition" class="table">
  <ng-template pTemplate="header">
    <tr>
      <th>STT</th>
      <th>Ảnh</th>
      <th>Tên</th>
      <th>Mô tả</th>
      <th>Giá bán</th>
      <th>Số lượng đã bán</th>
      <th>Màu sắc</th>
      <th>Size</th>
      <th>Trạng thái</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-product let-rowIndex="rowIndex">
    <tr>
      <td>
        {{
          ((currentPage - 1) * rowsPerPage + rowIndex + 1)
            .toString()
            .padStart(2, '0')
        }}
      </td>
      <td>
        <!-- <img
          [src]="product?.link_avt"
          [alt]="product?.name"
          style="width: 100%; object-fit: cover" /> -->
      </td>
      <td>{{ product?.name }}</td>
      <td>{{ product?.description }}</td>
      <td>{{ product?.price }}</td>
      <td>{{ product?.soldCount }}</td>
      <td>{{ product?.color }}</td>
      <td>{{ product?.size?.join(', ') }}</td>
      <td>
        <div
          style="
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
          ">
          <button class="button-action" (click)="onEditProduct(product)">
            <i class="pi pi-file-edit"></i>
          </button>
          <button class="button-action">
            <i class="pi pi-trash" (click)="onDeleteProduct(product)"></i>
          </button>
        </div>
      </td>
    </tr>
  </ng-template>
</p-table>

<div class="pagination">
  <span>Tổng số sản phẩm: {{ totalProducts }}</span>
  <div>
    <p-dropdown
      [options]="[5, 10, 15]"
      (onChange)="changeRowsPerPage($event)"
      class="dropdown"></p-dropdown>
    <span
      >Sản phẩm từ {{ startOrder }} đến {{ startOrder + rowsPerPage - 1 }}</span
    >
    <button (click)="onChangePage('previous')" [disabled]="currentPage === 1">
      <i class="pi pi-angle-left"></i>
    </button>
    <button
      (click)="onChangePage('next')"
      [disabled]="currentPage === lastPage">
      <i class="pi pi-angle-right"></i>
    </button>
  </div>
</div>

<p-dialog
  [(visible)]="isShowDialog"
  [draggable]="false"
  [resizable]="false"
  position="right"
  [style]="{ width: '28vw' }"
  [modal]="true"
  (onHide)="onCloseDialog()"
  class="fsel-dialog">
  <ng-template pTemplate="header"> Thêm sản phẩm </ng-template>
  <app-dialog-product
    *ngIf="isShowDialog"
    [selectedProduct]="selectedProduct"></app-dialog-product>
  <ng-template pTemplate="footer">
    <div class="button-list">
      <button class="button button-cancel" (click)="onCloseDialog()">
        HỦY
      </button>
      <button class="button button-add" (click)="addProduct()">THÊM</button>
    </div>
  </ng-template>
</p-dialog>
